{
    "hasRestrictedEnvironments": false,
    "id": 0,
    "identifier": "404f8ed3-d435-44db-ac1a-8b6384e3476d",
    "version": "0",
    "isEnabled": false,
    "isDebugMode": false,
    "name": "GuardDuty Alert Enrichment",
    "creator": "86c6281c-049f-42ca-8982-3a89c8758e4d",
    "modifiedBy": "86c6281c-049f-42ca-8982-3a89c8758e4d",
    "priority": 2,
    "description": "Enrich GuardDuty alerts with VirusTotal, retrying on failure, and block malicious IPs.",
    "environments": [
        "*"
    ],
    "categoryName": "Bharat",
    "categoryId": 32,
    "originalPlaybookIdentifier": "b507d763-5a9e-40b8-aafc-d0b57238a77e",
    "creationTimeUnixTimeInMs": 1734391030631,
    "modificationTimeUnixTimeInMs": 1734392097787,
    "trigger": {
        "id": 0,
        "identifier": "e3d5dfbe-11f6-4290-af3a-f626fb3c7b1c",
        "type": 3,
        "logicalOperator": 0,
        "conditions": [
            {
                "fieldName": "",
                "value": "AWS GuardDuty",
                "matchType": 0
            }
        ]
    },
    "steps": [
        {
            "parallelActions": [],
            "identifier": "00923666-7f3c-45d2-a36a-d036770d8705",
            "originalStepIdentifier": "0c3a952d-2b5f-4def-92fd-bd70524dfbf1",
            "isAutomatic": true,
            "isSkippable": false,
            "instanceName": "VirusTotalV3_Copy of Search Entity Graphs_1",
            "name": "VirusTotalV3_Copy of Search Entity Graphs",
            "integration": "VirusTotalV3",
            "description": "Search graphs based on the entities in VirusTotal. Supported entities: IP, URL, Filehash, Hostname, Threat Actor, User. Note: only MD5, SHA-1 and SHA-256 are supported.",
            "actionProvider": "Scripts",
            "actionName": "VirusTotalV3_Copy of Search Entity Graphs",
            "type": 0,
            "parameters": [
                {
                    "name": "AssignedUsers",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "AsyncActionTimeout",
                    "value": "86400",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "AsyncPollingInterval",
                    "value": "3600",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "DynamicInjectionInstancePlaceholder",
                    "value": "",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "FallbackIntegrationInstance",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "FetchInstanceByName",
                    "value": "false",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "HasApprovalLink",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "IntegrationInstance",
                    "value": "7d06722f-3bb6-45d4-ab5c-6856a2d91c68",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {},
                    "InstanceDisplayName": "VirusTotalV3_2"
                },
                {
                    "name": "MessageToAssignee",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "PendingActionTimeout",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "ScriptName",
                    "value": "VirusTotalV3_Copy of Search Entity Graphs",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "ScriptParametersEntityFields",
                    "value": "{\"Sort Field\":\"Name\",\"Max Graphs To Return\":\"10\"}",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "SelectedScopeName",
                    "value": "All entities",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                }
            ],
            "autoSkipOnFailure": false,
            "isDebugMockData": false,
            "debugData": null,
            "parentStepContainerId": null,
            "workflowIdentifier": "404f8ed3-d435-44db-ac1a-8b6384e3476d",
            "isTouchedByAi": false,
            "startLoopStepIdentifier": null,
            "id": 0,
            "creationTimeUnixTimeInMs": 1734392097787,
            "modificationTimeUnixTimeInMs": 1734392097787,
            "additionalProperties": {}
        },
        {
            "parallelActions": [],
            "identifier": "19a082b2-a6a0-44fb-b49b-1f5d18dfec0b",
            "originalStepIdentifier": "007300b3-4822-4fc9-98a8-5b1c404494e9",
            "isAutomatic": true,
            "isSkippable": false,
            "instanceName": "Tools_Attach Playbook to Alert_1",
            "name": "Tools_Attach Playbook to Alert",
            "integration": "Tools",
            "description": "This action can attach a playbook or block to an alert.",
            "actionProvider": "Scripts",
            "actionName": "Tools_Attach Playbook to Alert",
            "type": 0,
            "parameters": [
                {
                    "name": "AssignedUsers",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "DynamicInjectionInstancePlaceholder",
                    "value": "",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "FallbackIntegrationInstance",
                    "value": "ffde2201-fb0b-4e02-9bd8-cb50f9b44f3a",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {},
                    "FallbackInstanceDisplayName": "Tools_1"
                },
                {
                    "name": "FetchInstanceByName",
                    "value": "false",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "HasApprovalLink",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "IntegrationInstance",
                    "value": "AutomaticEnvironment",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "MessageToAssignee",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "PendingActionTimeout",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "ScriptName",
                    "value": "Tools_Attach Playbook to Alert",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "ScriptParametersEntityFields",
                    "value": "{\"Playbook Name\":\"GuardDuty Alert Enrichment\"}",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "SelectedScopeName",
                    "value": "All entities",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                }
            ],
            "autoSkipOnFailure": false,
            "isDebugMockData": false,
            "debugData": {
                "originalWorkflowIdentifier": "b507d763-5a9e-40b8-aafc-d0b57238a77e",
                "originalStepIdentifier": "007300b3-4822-4fc9-98a8-5b1c404494e9",
                "resultValue": "",
                "resultJson": "",
                "scopeEntitiesEnrichmentData": [],
                "id": 0,
                "creationTimeUnixTimeInMs": 0,
                "modificationTimeUnixTimeInMs": 0,
                "additionalProperties": {}
            },
            "parentStepContainerId": null,
            "workflowIdentifier": "404f8ed3-d435-44db-ac1a-8b6384e3476d",
            "isTouchedByAi": false,
            "startLoopStepIdentifier": null,
            "id": 0,
            "creationTimeUnixTimeInMs": 1734392097787,
            "modificationTimeUnixTimeInMs": 1734392097787,
            "additionalProperties": {}
        },
        {
            "parallelActions": [],
            "identifier": "e509f47c-49ca-4fc6-9dbe-0e7e9938890a",
            "originalStepIdentifier": "0638674c-c68f-4414-9d02-910ef08ff4dd",
            "isAutomatic": true,
            "isSkippable": false,
            "instanceName": "Previous Actions Conditions_1",
            "name": "Previous Actions Conditions",
            "integration": "Flow",
            "description": "This step conditions the progress of the playbook according to data fetched by previous actions performed in the playbook, for example: report data, action's success or enrichment data",
            "actionProvider": "Flow",
            "actionName": "IfElse",
            "type": 2,
            "parameters": [
                {
                    "name": "AssignedUsers",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "Branches",
                    "value": "[{\"LogicalOperator\":0,\"Conditions\":[{\"Operator\":0,\"FieldName\":\"VirusTotalV3_Copy of Search Entity Graphs_1.is_success\",\"Type\":2,\"Value\":\"false\"}],\"Order\":1,\"IsDefaultBranch\":false,\"Name\":\"Branch\"},{\"LogicalOperator\":0,\"Conditions\":[],\"Order\":2,\"IsDefaultBranch\":true,\"Name\":\"Branch\"}]",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "ErrorFallbackBranch",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "HasApprovalLink",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "MessageToAssignee",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "PendingActionTimeout",
                    "value": null,
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                },
                {
                    "name": "SelectedScopeName",
                    "value": "All entities",
                    "type": null,
                    "isMandatory": false,
                    "defaultValue": null,
                    "id": 0,
                    "creationTimeUnixTimeInMs": 0,
                    "modificationTimeUnixTimeInMs": 0,
                    "additionalProperties": {}
                }
            ],
            "autoSkipOnFailure": false,
            "isDebugMockData": false,
            "debugData": null,
            "parentStepContainerId": null,
            "workflowIdentifier": "404f8ed3-d435-44db-ac1a-8b6384e3476d",
            "isTouchedByAi": false,
            "startLoopStepIdentifier": null,
            "id": 0,
            "creationTimeUnixTimeInMs": 1734392097787,
            "modificationTimeUnixTimeInMs": 1734392097787,
            "additionalProperties": {}
        }
    ],
    "stepsRelations": [
        {
            "condition": "1",
            "fromStep": "e509f47c-49ca-4fc6-9dbe-0e7e9938890a",
            "toStep": "19a082b2-a6a0-44fb-b49b-1f5d18dfec0b",
            "destinationActionStatus": 0
        },
        {
            "condition": "",
            "fromStep": "00923666-7f3c-45d2-a36a-d036770d8705",
            "toStep": "e509f47c-49ca-4fc6-9dbe-0e7e9938890a",
            "destinationActionStatus": 0
        }
    ],
    "templateName": null,
    "playbookType": 0,
    "debugData": {
        "debugBaseAlertId": null,
        "debugAlertId": null
    },
    "entityAccessLevel": 2,
    "defaultAccessLevel": 2,
    "permissions": [],
    "overviewTemplates": [],
    "creationSource": 1
}